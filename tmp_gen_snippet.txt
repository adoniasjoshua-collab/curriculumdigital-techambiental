async function generatePDF() {
    // Validate libraries
      if (!window.html2canvas || !window.jspdf || !window.jspdf.jsPDF) {
        alert("Bibliotecas de exportação PDF não carregadas. Tente recarregar a página.");
        window.print();
        return;
      }

      const jsPDF = window.jspdf.jsPDF;

      // Prepare element to capture
      const resumeElement = document.querySelector("#main-content");
      if (!resumeElement) {
        alert("Erro: Não foi possível encontrar o conteúdo para exportar.");
        return;
      }

      // Hide elements that should not be captured (if any)
      const screenHeader = document.querySelector(".resume-header-print");
      if (screenHeader) screenHeader.style.display = "none";

      try {
      // Ensure fonts loaded and allow rendering to settle
        if (document.fonts && document.fonts.ready) await document.fonts.ready;
        await new Promise(r => setTimeout(r, 500));

        // Step 1 capture: render at target pixel width for 300dpi A4 (2480 x 3508 px)
        const desiredPxWidth = 2480; // A4 @300dpi width
        const elementRect = resumeElement.getBoundingClientRect();
        const scale = desiredPxWidth / Math.max(1, Math.round(elementRect.width));

        const canvas = await html2canvas(resumeElement, {
          scale: scale,
          useCORS: true,
          backgroundColor: "#ffffff",
          scrollY: -window.scrollY
        });

        const canvasWidth = canvas.width;
        const canvasHeight = canvas.height;

        // Step 2 paginate: split canvas into A4 slices (3508 px height)
        const pagePixelHeight = 3508; // A4 @300dpi height
        const totalPages = Math.ceil(canvasHeight / pagePixelHeight);

        // Create PDF in points (pt) to match 1in=72pt margins
        const pdf = new jsPDF("portrait", "pt", "a4");
        const pageWidthPt = pdf.internal.pageSize.getWidth();
        const pageHeightPt = pdf.internal.pageSize.getHeight();
        const marginPt = 72; // 1 inch
        const contentWidthPt = pageWidthPt - marginPt * 2;

        for (let page = 0; page < totalPages; page++) {
        // Create a page-sized canvas and draw the slice
          const sliceHeight = Math.min(pagePixelHeight, canvasHeight - page * pagePixelHeight);
          const pageCanvas = document.createElement("canvas");
          pageCanvas.width = canvasWidth;
          pageCanvas.height = sliceHeight;
          const ctx = pageCanvas.getContext("2d");
          ctx.fillStyle = "#ffffff";
          ctx.fillRect(0, 0, pageCanvas.width, pageCanvas.height);
          ctx.drawImage(canvas, 0, page * pagePixelHeight, canvasWidth, sliceHeight, 0, 0, canvasWidth, sliceHeight);

          // Convert to image and add to PDF
          const imgData = pageCanvas.toDataURL("image/jpeg", 1.0);
          const imgWidthPt = contentWidthPt;
          const imgHeightPt = (sliceHeight * (imgWidthPt / canvasWidth));

          if (page > 0) pdf.addPage();
          // Step 2.5 add header (name/title) at top of each page
          pdf.setFillColor(255,255,255);
          pdf.rect(0,0,pageWidthPt,pageHeightPt,"F");
          pdf.setFont("helvetica", "bold");
          pdf.setFontSize(14);
          pdf.setTextColor(38,70,83);
          pdf.text("Adonias Pereira da Silva", marginPt, marginPt - 20);
          pdf.setFontSize(10);
          pdf.setTextColor(107,112,92);
          pdf.text("Desenvolvedor Full Stack — Sustentabilidade e Automação", marginPt, marginPt - 6);

          pdf.addImage(imgData, "JPEG", marginPt, marginPt, imgWidthPt, imgHeightPt);

          // Footer with page number and date
          const currentDate = new Date().toLocaleDateString("pt-BR");
          const footerText = `Currículo — ${currentDate}  •  Página ${page + 1} de ${totalPages}`;
          pdf.setFontSize(9);
          pdf.setTextColor(107,112,92);
          pdf.text(footerText, pageWidthPt - marginPt, pageHeightPt - 36, { align: "right" });
        }

        // Step 3 save
        pdf.save("Curriculo_Adonias_PROD10X.pdf");
      } catch (err) {
        console.error("Erro ao gerar PDF:", err);
        alert("Erro ao gerar PDF. Usando fallback de impressão.");
        window.print();
      } finally {
      // Restore header visibility
        if (screenHeader) screenHeader.style.display = "";
      }
    }

    
